<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#0f172a" />
    <meta name="description" content="Panel SIRH para gestión de empleados, contratos y reportes." />
    <title>Molino de Arroz - SIRH | Panel</title>
    <link rel="stylesheet" href="/styles.css" />
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
  </head>
  <body>
    <header class="topbar">
      <div class="brand">
        <img src="/favicon.svg" alt="" class="logo" />
        <h1>Molino de Arroz – SIRH</h1>
      </div>
      <nav class="tabs" role="tablist" aria-label="Secciones del panel">
        <button class="tab-btn active" role="tab" aria-selected="true" aria-controls="tab-empleados" data-tab="empleados">Empleados</button>
        <button class="tab-btn" role="tab" aria-selected="false" aria-controls="tab-contratos" data-tab="contratos">Contratos</button>
        <button class="tab-btn" role="tab" aria-selected="false" aria-controls="tab-busqueda" data-tab="busqueda">Reportes</button>
      </nav>
      <button id="logoutBtn" class="btn">Salir</button>
    </header>

    <main class="container">
      <!-- Empleados -->
      <section id="tab-empleados" class="tab active">
        <h2>Gestión de empleados</h2>
        <!-- Barra superior: solo estadísticas -->
        <div class="toolbar" aria-label="Herramientas de empleados">
          <div class="stats" aria-label="Estadísticas de empleados">
            <div class="stat"><div class="stat-label">Total</div><div id="emp_stat_total" class="stat-value">0</div></div>
            <div class="stat"><div class="stat-label">Activos</div><div id="emp_stat_activos" class="stat-value">0</div></div>
            <div class="stat"><div class="stat-label">Retirados</div><div id="emp_stat_retirados" class="stat-value">0</div></div>
          </div>
        </div>
        <form id="employeeForm" class="form grid2">
          <input type="hidden" id="emp_id" />
          
          <div>
            <label>Número de documento</label>
            <input id="emp_doc" required inputmode="numeric" pattern="^[0-9]{6,20}$" title="Debe contener entre 6 y 20 dígitos" placeholder="Ej: 123456789" />
          </div>
          <div>
            <label>Nombre</label>
            <input id="emp_nombre" required maxlength="40" placeholder="Ej: Juan" />
          </div>
          <div>
            <label>Apellido</label>
            <input id="emp_apellido" required maxlength="40" placeholder="Ej: Pérez" />
          </div>
          <div>
            <label>Edad</label>
            <input id="emp_edad" type="number" min="16" max="80" required />
          </div>
          <div>
            <label>Género</label>
            <select id="emp_genero">
              <option>Masculino</option>
              <option>Femenino</option>
              <option>No especifica</option>
            </select>
          </div>
          <div>
            <label>Cargo</label>
            <input id="emp_cargo" placeholder="Operario, Supervisor, etc." maxlength="60" />
          </div>
          <div>
            <label>Correo</label>
            <input id="emp_correo" type="email" required placeholder="usuario@empresa.com" />
          </div>
          <div>
            <label>Número de contacto</label>
            <input id="emp_contacto" required inputmode="tel" pattern="^[0-9+\-\s]{7,20}$" title="Ingrese entre 7 y 20 caracteres (números, +, -, espacio)" placeholder="Ej: 321 555 1234" />
          </div>
          <div>
            <label>Estado</label>
            <select id="emp_estado">
              <option value="activo">Activo</option>
              <option value="retirado">Retirado</option>
            </select>
          </div>
          <div class="span2">
            <label>Observaciones</label>
            <textarea id="emp_obs" rows="2" placeholder="Anotaciones, llamados de atención, etc."></textarea>
          </div>
          <div class="span2 actions">
            <button type="submit" class="btn primary">Guardar</button>
            <button type="reset" class="btn">Limpiar formulario</button>
          </div>
          <div id="empMsg" class="msg span2" role="status" aria-live="polite"></div>
        </form>
        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th data-sort="NRO_DOCUMENTO">Documento</th>
                <th data-sort="NOMBRE">Nombre</th>
                <th data-sort="CARGO">Cargo</th>
                <th data-sort="ESTADO">Estado</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody id="employeesTable"></tbody>
          </table>
        </div>
        
      </section>

      <!-- Contratos -->
      <section id="tab-contratos" class="tab">
        <h2>Gestión de contratos</h2>

        <!-- Barra superior con filtro y resumen -->
        <div class="toolbar">
          <div class="filters">
            <label for="con_filter" class="sr-only">Filtrar por empleado</label>
            <select id="con_filter" class="pill"></select>
            <button id="con_clear_filter" class="btn secondary sm">Ver todos</button>
          </div>
          <div class="stats">
            <div class="stat">
              <div class="stat-label">Contratos</div>
              <div id="con_stat_total" class="stat-value">0</div>
            </div>
            <div class="stat">
              <div class="stat-label">Valor total</div>
              <div id="con_stat_monto" class="stat-value">$0</div>
            </div>
          </div>
        </div>

        <!-- Formulario de creación/edición -->
        <div class="card">
          <h3>Nuevo contrato</h3>
          <form id="contractForm" class="form grid2">
            <input type="hidden" id="con_id" />
            <div>
              <label>Empleado</label>
              <select id="con_emp_select"></select>
            </div>
            <div>
              <label>Fecha inicio</label>
              <input id="con_inicio" type="date" required />
            </div>
            <div>
              <label>Fecha fin</label>
              <input id="con_fin" type="date" required />
            </div>
            <div>
              <label>Valor del contrato (COP)</label>
              <input id="con_valor" type="number" min="0" step="1000" required />
            </div>
            <div class="span2 actions">
              <button type="submit" class="btn primary">Guardar</button>
              <button type="reset" class="btn">Limpiar formulario</button>
            </div>
            <div id="conMsg" class="msg span2" role="status" aria-live="polite"></div>
          </form>
        </div>

        <!-- Tabla de contratos -->
        <div class="card">
          <h3>Listado de contratos</h3>
          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th>Empleado</th><th>Inicio</th><th>Fin</th><th>Valor</th><th>Acciones</th>
                </tr>
              </thead>
              <tbody id="contractsTable"></tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- Búsqueda y exportación -->
      <section id="tab-busqueda" class="tab">
        <h2>Consulta de contratos por empleado</h2>
        <div class="form grid2">
          <div class="span2">
            <label>Buscar por número de documento o nombre</label>
          <input id="search_q" placeholder="Ej: 123456789 o Juan" />
          </div>
          <div class="actions">
            <button id="searchBtn" class="btn primary">Buscar</button>
          </div>
        </div>
        <div id="searchResult" class="card"></div>
        <div id="searchMsg" class="msg" role="status" aria-live="polite"></div>
        <div class="actions">
          <button id="pdfBtn" class="btn">Descargar PDF</button>
          <button id="xlsxBtn" class="btn">Descargar XLSX</button>
        </div>
      </section>
    </main>

    <script src="/js/app.js" type="module"></script>
    <!-- Toast de estado (sin modal de confirmación) -->
    <div id="toast" class="toast" role="status" aria-live="polite" hidden></div>
  </body>
  </html>